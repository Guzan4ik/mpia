# multipart_image_augmentation

### Описание свойств
Перед запуском необходимо составить словари с классами, типами объектов и свойствами для каждого объекта.
Примеры находятся в `metadata.py`
Нулевой класс считается дефолтным для каждого свойства или класса.

object_classes - содержит все названия классов;

object_type - типы объектов;

properties - все свойства, которые могут всречаться в датасете. 

У каждого типа свойства могут быть разные категории, например, свойство "здоровье", которое может состоять из "здоровый", "больной", "гнилой" и пр. Первый всегда дефолтный.

object_type2properties - какие типы свойств могут быть у конкретного объкта. `{id_obj: [properties1, properties2, ..., properties_n]}`. Если у какого-то типа не может быть данного свойства, то его обозначают как -1.

Примеры классов, их идентификаторов и свойств, представленных в датасетах:

```object_type = {"background": 0,
              "stem": 1,  
              "leaf": 2, 
              "fruit": 3,
              "flower": 4,
              "root": 5,
              "swimming_pool": 6,
              "field": 7,
              "building": 8,
              "tree": 9,
              "road": 10,
              "other": 11}```


```object_type_ru = {"фон": 0,
              "стебель": 1,  
              "лист": 2, 
              "фрукт": 3,
              "цветок": 4,
              "корень": 5,
              "бассейн": 6,
              "поле": 7,
              "здание": 8,
              "дерево": 9,
              "дорога": 10,
              "прочее": 11}```

```properties = {"condition": ["healthy", "dried", "diseased", "rotten", "partially damaged"],
              "type": ["herbaceous", "woody"],
              "ierarchy": ["main",  "side"],
              "group": ["single", "group"],
              "kind": ["flat", "other"],
              "ripeness": ["ripe", "unripe"],
              "stage": ["growing", "harvested", "packed"],
              "integrity": ["whole", "cutted"] 
             }```
             

#### Добавление названий классов в аннотацию

Если в аннотации нет tags с классом, то его можно добавить вручную, используя .csv файл, с названиями изображений и соответствующим классом, на изображении.
Пример:

`grape_1.jpg,grape`

Необходимо вызвать метод `update_annotation.add_class_name(path_annotation, df_path)`

path_annotation - путь к директории с аннотациями без классов

df_path - путь к .csv файлу с классами



### Запуск

`python main.py --path-ann ./ann/ --all-ann /all_metadata.json`

где path-an - путь к файлм с аннотацией

all-ann - имя файла для аннотации датасета

В результате, в директорию, где была аннотация, записывается новая аннотация для каждого изображения. Также получаем единый файл методанных для всего датасета, в котором собрана статистика по всем свойствам, классам и типам объектов.



